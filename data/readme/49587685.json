{
  "read_at": 1462552999, 
  "description": "Reconstruction of phylogenetic insertion-deletion histories", 
  "README.md": "# Indel Historian\nReconstruction of evolutionary indel & substitution histories using the phylogenetic transducer method\n(see [Westesson et al, 2012](http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0034572) for an evaluation and brief description of the method, or [this arXiv report](http://arxiv.org/abs/1103.4347) for a tutorial introduction).\n\n<pre><code>\nUsage: historian {recon[struct],count,fit,help,version} [options]\n\nEXAMPLES\n\nReconstruction:\n  historian recon seqs.fa [-tree tree.nh] -output fasta &gt;reconstruction.fa\n  historian recon -guide guide.fa [-tree tree.nh] &gt;reconstruction.stk\n  historian recon guide.stk &gt;reconstruction.stk\n  historian recon data.nex -output nexus &gt;reconstruction.nex\n\nEvent counting:\n  historian count seqs.fa [-tree tree.nh] [-model model.json] &gt;counts.json\n  historian count -guide guide.fa [-tree tree.nh] &gt;counts.json\n  historian count -recon reconstruction.fa -tree tree.nh &gt;counts.json\n\nModel fitting:\n  historian fit seqs.fa &gt;newmodel.json\n  historian fit -counts counts.json &gt;newmodel.json\n\nCommands can be abbreviated to single letters, like so:\n  historian r seqs.fa &gt;reconstruction.stk\n  historian c seqs.fa &gt;counts.json\n  historian f -counts counts.json &gt;model.json\n(etc.)\n\nOPTIONS\n\nReconstruction file I/O options:\n  -auto &lt;file&gt;    Auto-detect file format and guess its purpose\n  -model &lt;file&gt;   Specify substitution & indel model (JSON)\n  -seqs &lt;file&gt;    Specify unaligned sequences (FASTA)\n  -guide &lt;file&gt;   Specify guide alignment (gapped FASTA)\n  -tree &lt;file&gt;    Specify phylogeny (New Hampshire)\n  -nexus &lt;file&gt;, -stockholm &lt;file&gt;\n                  Specify phylogeny & guide alignment together\n\n  -saveguide &lt;f&gt;  Save guide alignment to file\n                   (guide tree too, if output format allows)\n  -output (nexus|fasta|stockholm)\n                  Specify output format (default is Stockholm)\n\nReconstruction algorithm options:\n\nThe reconstruction algorithm iterates through the guide tree in postorder,\naligning each sibling pair and reconstructing a profile of their parent.\nThe dynamic programming is constrained to a band around a guide alignment,\nand the reconstructed parent profile is a weighted finite-state transducer\nsampled from the posterior distribution implied by the children. The band\nsize, posterior probability threshold for inclusion in the parent profile,\nand number of states in the parent profile can all be tweaked to trade off\nsensitivity vs performance.\n\n  -band &lt;n&gt;       Size of band around guide alignment (default 10)\n  -noband         Unlimit band, ignore guide alignment\n  -minpost &lt;p&gt;    Posterior prob. threshold for profile states (default .01)\n  -states &lt;n&gt;     Limit max number of states per profile\n\n  -ancseq         Predict ancestral sequences (default is to leave them as *'s)\n  -ancprob        Report posterior probabilities for ancestral residues\n\nGuide alignment & tree estimation options:\n\nThe guide aligner builds a maximal spanning tree of pairwise alignments.\nIt can be accelerated in two ways: (1) by using a sparse random forest\ninstead of a fully connected all-vs-all pairwise comparison; and (2) by\nconfining the pairwise DP matrix to cells around a subset of diagonals\nthat contain above a threshold number of k-mer matches. To turn on the\nformer optimization, use -rndspan; the latter is turned on by default for\nsequences whose full DP matrix would not otherwise fit in memory (the\nmemory threshold can be set with -kmatchmb). It can be disabled with\n-kmatchoff, or enabled (for a particular k-mer threshold) with -kmatchn.\n\n  -rndspan        Use a sparse random spanning graph, not all-vs-all pairs\n  -kmatchn &lt;n&gt;    Threshold# of kmer matches to seed a diagonal\n                   (default sets this as low as available memory will allow)\n  -kmatch &lt;k&gt;     Length of kmers for pre-filtering heuristic (default 6)\n  -kmatchband &lt;n&gt; Size of DP band around kmer-matching diagonals (default 64)\n  -kmatchmb &lt;M&gt;   Set kmer threshold to use M megabytes of memory\n  -kmatchoff      No kmer threshold, do full DP\n\n  -upgma          Use UPGMA, not neighbor-joining, to estimate tree\n\nModel-fitting and event-counting options:\n\nBy default, the reconstruction algorithm will interpret any supplied alignment\nas a guide alignment, i.e. a hint, even if it contains a full ancestral sequence\nreconstruction. To insist that the alignment be interpreted as a reconstruction,\nprecede it with -recon, -nexusrecon or -stockrecon (depending on the format).\n\n  -recon &lt;file&gt;, -nexusrecon &lt;file&gt;, -stockrecon &lt;file&gt;\n                  Use precomputed reconstruction (FASTA/NEXUS/Stockholm)\n  -mininc &lt;n&gt;     EM convergence threshold as relative log-likelihood increase\n                   (default is .001)\n  -maxiter &lt;n&gt;    Max number of EM iterations (default 100)\n  -nolaplace      Do not add Laplace +1 pseudocounts during model-fitting\n  -fixsubrates    Do not estimate substitution rates or initial composition\n  -fixgaprates    Do not estimate indel rates or length distributions\n\nGeneral options:\n  -verbose, -vv, -vvv, -v4, -v5, etc.\n                  Various levels of logging (-nocolor for monochrome)\n  -V, --version   Print GNU-style version info\n  -h, --help      Print help message\n  -seed &lt;n&gt;       Seed random number generator (mt19937; default seed 5489)\n\nREFERENCES\n\nThe reconstruction method uses phylogenetic transducers, as described in:\n  Westesson, Lunter, Paten & Holmes (2012). Accurate Reconstruction of\n  Insertion-Deletion Histories by Statistical Phylogenetics.\n  PLoS One, DOI: 10.1371/journal.pone.0034572\n  http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0034572\n\nA longer, tutorial-style introduction is available here:\n  Westesson, Lunter, Paten & Holmes (2012).\n  Phylogenetic Automata, Pruning, and Multiple Alignment.\n  http://arxiv.org/abs/1103.4347\n\nModel-fitting uses the following phylogenetic EM algorithm:\n  Holmes & Rubin (2002). An Expectation Maximization Algorithm\n  for Training Hidden Substitution Models.\n  Journal of Molecular Biology, 317(5).\n\n</code></pre>\n", 
  "id": 49587685
}