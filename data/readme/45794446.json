{
  "read_at": 1462554551, 
  "description": "Voles prey-predator model", 
  "README.md": "This package contains the voles-weasels prey-predator model described in [Fasiolo and Wood, 2015](http://arxiv.org/abs/1511.02644), which\nis a modified version of that originally proposed by Turchin and Ellner, 2000.\nThe documentation is fairly sparse, but most of the information is contained in the paper.\n\nThe function `volesSimulator` can be used to simulate data from the model, see `?volesSimulator` for \ninformations about its arguments. The following code simulates data from the model\n\n```R\nlibrary(volesModel)\n\n########## Simulating from full model \nset.seed(76735756)\nnSteps <- 50\nnObs <- 500\nres <- volesSimulator(nObs = nObs, nsim = 100, nBurn = 120, model = \"full\", \n                      param = log(c(r = 4.5, e = 1, g = 0.12, h = 0.1,\n                                    a = 8, d = 0.04, s = 1.25, \n                                    sigmaProc = 1.5, phi = 100)), \n                      nSteps = nSteps, T0 = 0)\n\nii = 1\npar(mfrow = c(2, 1))\nplot(res[[1]][ii, ], type = 'l', main = \"Voles\", ylab = \"Voles\", xlab = \"Semester\")\nplot(res[[2]][ii, ], type = 'l', main = \"Weasels\", ylab = \"Weasels\", xlab = \"Semester\")\nii = ii + 1\n```\n\nThe model contains the real dataset described in ([Fasiolo and Wood, 2015](http://arxiv.org/abs/1511.02644)),\nwhich can be loaded using `data(voles_data)`. \nTo fit the model with Synthetic Likelihood (Wood, 2010), we need to load the [synlik package](https://cran.r-project.org/web/packages/synlik/index.html) and\nthen create an object of class `synlik`. Notice that here we use the wrapper `volesWrap`, rather than `volesSimulator`, \nfor compatibility with `synlik`.\n\n```R\n# This is needed because the process is observed only in \n# the months of June and September, for 45 years\nobsTiming <- sort(c(6 + seq(0, 12 * 44, by = 12), 9 + seq(0, 12 * 44, by = 12)))\n\n# Create \"synlik\" object\nvoles_sl <- new(\"synlik\",\n                simulator = volesWrap,\n                summaries = volesStats,\n                param = log(c(r = 4.5, e = 1, g = 0.2, h = 0.15, a = 8,\n                              d = 0.06, s = 1, sigmaProc = 1.5, phi = 100)),\n                extraArgs = list(\"nObs\" = 12 * 45,  \n                                 \"nBurn\" = 12 * 10, \n                                 \"monthsToSave\" = obsTiming)\n)\n\n# Put real data into object\ndata(voles_data)\nvoles_sl@data <- round(voles_data$popDensity * 10)\nvoles_sl@extraArgs$obsData <- round(voles_data$popDensity * 10)\n```\n\nWe can than fit the model using a Metropolis-Hastings sampler.\n\n```R\n# Load MCMC proposal\ndata(voleFullProp_sl)\n\n# Run MCMC on synthetic likelhood (only 100 iterations and it takes a while)\nset.seed(51554)\ntim <- proc.time()\nvoles_sl <- smcmc(voles_sl, \n                  initPar = voleFullTrueInit_sl,\n                  nsim = 1000,\n                  niter = 100, \n                  burn = 0,\n                  priorFun = voleFullPrior_sl, \n                  propCov = 0.1 * voleFullProp_sl)\n)\ntim <- proc.time() - tim\n\nplot(voles_sl)\n```\n\n\nReferences\n----------------------------\n  \n  * Fasiolo, M and Wood, S. N. (2015). Approximate methods for dynamic ecological models, \n  ArXiv http://arxiv.org/abs/1511.02644. To appear in the Handbook of Approximate Bayesian Computation by S. Sisson, L. Fan, and M. Beaumont.\n\n  * Turchin, P. and S. P. Ellner (2000). Living on the edge of chaos: population\ndynamics of fennoscandian voles. Ecology 81 (11), 3099-3116.\n\n  * Wood, S. N. (2010). Statistical inference for noisy nonlinear ecological dynamic systems. Nature 466 (7310), 1102-1104.\n", 
  "id": 45794446
}