{
  "read_at": 1462556999, 
  "description": "Crowdsourced image quality control for the Dark Energy Survey", 
  "README.md": "# DES Exposure Checker\n\nCrowdsourced image quality control for the Dark Energy Survey (DES). The code available here is for a web-app that asks users to identify flaws in survey images. The app loads and displays FITS image directly in the browser and works on desktop and mobile devices.\n\nMore details can be found in the associated paper (submitted to Astronomy & Computing): \n\nhttp://arxiv.org/abs/1511.03391\n\nA live demo version of the exposure checker in action can be found here:\n\nhttp://des-exp-checker.pmelchior.net\n\nThe license is MIT. Feel free to use and modify, but please cite our paper if you do.\n\n## Installation\n\nThe app requires a webserver (tested on apache and nginx) with PHP and SQLite support. Then:\n\n1. Clone the repository and go into the new directory.\n2. Copy `htaccess.txt` to `.htaccess` and append whatever else may be needed for your installation.\n3. Execute \n\n   ```\n   sqlite3 files.db < sql/files.sql\n   sqlite3 users.db < sql/users.sql\n   ```\n\n   This step creates two empty database files `files.db` and `users.db`, move them into a directory the webserver can access but that is hidden from direct access. Because of `.htaccess`, files and directories that start with a `.` are inaccessible when requested through the webserver, so you do:\n\n   ````\n   mkdir .db\n   mv files.db users.db .db/\n   ````\n\n   Once there, make sure that the webserver user can read from and write to those files. \n4. Load information about the test images into the file database. As you can see from the schema in `sql/files.sql`,  each image needs to have 4 items of information:\n\n   ```sql\n   expname TEXT,\n   ccd INT,\n   band TEXT,\n   name TEXT\n   ```\n\n   `ccd` and `band` should be obvious, `expname` is the short but unique name of the exposure, and `name` (as a bit of a misnomer) is actually the filename of the FITS file in question. No full paths are needed, you'll set them in  `$config['fitspath']` next.\n\n5. Copy `config.php.template` to `config.php.inc` and edit as needed (see below).\n6. On a production environment: Remove `.git`, `htaccess-minimum.txt`, `config.php.template`, and `README.md`.\n\n## Configuration\n\n###Config.php.inc\n\nThis file contains almost all of the particular configuration for the server and the location of files. Its content is:\n\n```php\n$config = array(\n    \"adminemail\" => T_STRING,   // email address used for contact\n    \"adminname\" => T_STRING,    // name used for admin emails\n    \"domain\" => T_STRING,       // webserver domain name\n    \"releases\" => T_ARRAY,\t    // list of available releases\n    \"userdb\" => T_STRING,       // path to the user database\n    \"filedb\" => T_ARRAY,        // release => path to file database\n    \"fovpath\" => T_ARRAY,       // release => path to FoV images\n    \"fitspath\" => T_ARRAY       // release => path to fits files\n    \"images_per_fp\" => T_INT,   // size of focal plane, used for congrats\n    \"release\" => NULL,          // empty, set later\n    \"problem_code\" => T_ARRAY   // problem label => numeric code\n);\n```\n\nThe code has a mechanism to swich between data releases. For that define a list of releases, e.g. \n\n```php\n \"releases\" => array(\"SVA1\", \"Y1A1\")\n```\n\n Set the arrays for `filedb`, `fovpath`,`fitspath` with one key-value pair for each release, e.g. \n\n```php\n\"filedb\" => array(\"SVA1\" => \".db/files.sva1.db\", \n                  \"Y1A1\" => \".db/files.y1a1.db\")\n```\n\n###Releases\n\nOpen the file `release_selector.shtml` and modify as needed. The name of each release must be the content of HTML node of `class=\"release-button\"` like\n\n```html\n<a class=\"release-button\" href=\"#\">SVA1</a>\n```\n\n###Problem classes\n\nProblem classes are defined in two different locations: As textual labels for frontend users and as numbers for the server (the reduce overhead and storage requirements in the file databases).\n\n1. Open `problem_selector.shtml` and modify as needed. For a label to be working as intended, it needs to be the content of an HTML node of `class=\"problem\"`, e.g.\n\n   ```html\n   <a class=\"problem\" href=\"#\">Column mask</a>\n   ```\n\n2. Open `config.php.inc` again and make sure each problem label has a numeric code in `$config['problem_code']`, e.g.\n\n   ```php\n   $config['problem_code'] = array(\n   \t\"OK\" => 0, // DO NOT CHANGE!\n       \"Other...\" => 999,  // DO NOT CHANGE!\n       \"Awesome!\" => 1000, // DO NOT CHANGE!\n       \"Column mask\" => 1,\n       ...\n       )\n   ```\n\n## API\n\nIn addition to the frontend statistics pages, user generated reports can be queried with an API. The path is\n\n```\napi.php?release=SVA1&problem=Column%20mask\n```\n\nThe parameter `release` needs to be from `$config['releases']` and problem needs to be a key in `$config['problem_codes']`. If necessary, both need to be urlencoded.\n\nThe API returns JSON of the following form:\n\n```javascript\n[\n  {\"qa_id\": number,\n  \"expname\": string,\n  \"ccd\": number,\n  \"band\": string,\n  \"problem\": string,\n  \"x\": number,\n  \"y\": number,\n  \"detail\": null or string,\n  \"false_positive\": true or false,\n  \"release\": string\n  }\n]\n```\n\nThe list has one of dictionary per reported problem that matches the request. `qa_id` is a unique identifier of the report in the given `release`, `x/y` are the CCD coordinates of the center of the problem marker, `detail` (only set for labels \"Other...\" and \"Awesome!\") is a user-generated text to describe the report.\n", 
  "id": 11187748
}