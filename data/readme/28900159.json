{
  "id": 28900159, 
  "read_at": 1462551864, 
  "README.rst": "PyPegase 0.1\n============\n\nIntroduction\n------------\n\nPyPegase provides a convenient way to generate galaxy models using the `PEGASE <http://www2.iap.fr/users/fioc/PEGASE.html>`_ version 2 code. It provides a wrapper class that encapsulates\nthe parameters to, and results from the PEGASE binaries. This makes it much simpler to explore the paramater space and examine the outputs from\nthe resulting models.\n       \nPyPegase assumes you have a clean installation of the PEGASE2 code, and have compiled the Fortran sources to produce executable binaries called ``SSPs``,\n``scenarios``, ``spectra``, ``calib`` and ``colors``.\n\nFor more on PEGASE see the docs: http://arxiv.org/abs/astro-ph/9912179\n\nInstallation and configuration\n------------------------------\n\nIf you use pip, install with::\n\n  pip install pypegase\n\nalternatively, get from github::\n\n  git clone https://github.com/coljac/pypegase.git\n\nand add the directory to your ``PYTHONPATH`` environment variable.\n\nYou will also need to point PyPegase to your PEGASE2 directory, the location of the binaries (such as ``SSPs``, etc). The best way to do this is with a ``PEGASE_HOME`` environment variable, but can be done at runtime by setting ``PEGASE.pegase_dir = \"<path to PEGASE>\"``.\n\nYou can also create a ``.pypegase`` file to override the module's defaults - see defaults_ below.\n\nUsage\n-----\n\nUsage of PyPegase is centred on the PEGASE class which encapsulates a run of the PEGASE code. Other classes such\nas ``IMF``, ``SSP``, ``SFR`` and ``Scenario`` wrap the inputs to the PEGASE code, though use of\nthese is in most cases optional.\n\nThe basic workflow is as follows:\n\n- Create an ``IMF`` object for your model (optional)\n- Create an ``SSP`` object with the IMF (optional)\n- Create one or more ``Scenario`` objects (optional)\n- Create ``PEGASE`` instance, passing in the above\n- Invoke ``.generate()`` on the ``PEGASE`` object, which generates the data files\n- Access the results via the ``colors()`` and ``spectra()`` methods\n- Save the resulting object with ``save_to_file()`` so it can be later loaded with ``PEGASE.from_file()`` and save on generation time.\n\nAll of this can be done in one line, see the examples below.\n\nNote that all the outputs created by PEGASE end up in the PEGASE home directory.\n\n.. _defaults:\n\nDefaults\n--------\n\nThe default values are all as per the PEGASE documentation and code, with the following exceptions:\n\n- The default IMF is Salpeter 1955\n- The default SFR is exponentially decreasing instead of instantaneous burst, with the default values for p1 and p2 as per the code (1000 and 1 respectively).\n\nFor convenience, defaults can be overridden by creating a file ``.pypegase`` in your home directory. It\nshould have the format::\n  \n  variable = value\n  variable2 = value2\n  ...\n\nTo see the built-in defaults, execute ``PEGASE.list_defaults()``. You can use this string as a template. To get started, try::\n\n  python -c \"import pypegase as pp; pp.PEGASE.list_defaults()\" > ~/.pypegase\n\nThis will create an file for you that you can edit should you wish to override some of the defaults. (Note: If pypegase.py is not in your system's library dir, you will need it in the current directory or you can add the location of pypegase.py to to ``PYTHONPATH`` environment variable.)\n\nSpectra and colors\n------------------\n\nGenerated spectra and colors data can be obtained with the ``spectra()`` and ``colors()`` methods respectively. In each case the result will be an Astropy `table.Table <http://docs.astropy.org/en/stable/table/index.html>`_  with a row for each timestep. \n\nBoth of these methods can take a list of columns as the ``cols`` parameter. For spectra especially the resulting table is very large and it may make sense to filter the results in this way. The available column names are the wavelengths and spectral lines as they appear in the xxx_spectra.dat file as well as the following::\n\n        time m_gal m_star m_wd m_nsbh m_substellar m_gas z_ism z_stars_mass\n        z_stars_bl l_bol od_v l_dust_l_bol sfr phot_lyman rate_snii rate_snia \n\tage_star_mass age_star_lbol\n \nNote that column names must match PEGASE's file output exactly - so for instance  \"100200.\" will work, but\n\"100200\" will not.\n\t\nThe available column names can be viewed with ``peg_instance.spectra().colnames()`` (and the same for colors).\n\nThe table returned by these methods can be further filtered with the ``time_lower`` and ``time_upper`` keywords; for example, to return only rows with a time between 100 and 13000 Myr, call ``colors(time_lower=100, time_upper=13e3)``.\n\nThese methods return a table which can be accessed as ``mytable['colname']`` (returns entire column) or ``mytable['colname'][n]`` (returns column _colname_ at row _n_).\n\nExamples\n--------\nGenerate a set of data using the defaults, in files prefixed with ``mydata_``::\n\n    from pypegase import *\n    import matplotlib.pyplot as plt\n\n    PEGASE.pegase_dir = '/home/me/PEGASE.2/' # unless PEGASE_HOME is set\n\n    peg = PEGASE('mydata') # default IMF, Scenario, etc\n    peg.generate() # some minutes may be required, console will show progress\n    colors = peg.colors()\n    colors['B-V'][-1] # B-V color at last timestep (20 Gyr) = .922\n    plt.plot(colors['time'], colors['B-V']) # plot times versus B-V color\n    plt.plot(colors['time'], colors['B-V'], \"b-\", label=\"B-V\") # plot times versus B-V color\n    plt.plot(colors['time'], colors['g-r'], \"g-\", label=\"g-r\")\n    plt.legend(loc = 'lower right', numpoints=1)\n\n    peg.save_to_file(peg.name + '.peg')\n\n    peg2 = PEGASE.from_file(peg.name + '.peg')\n    peg2.colors() # Same as above\n\n.. image:: images/example1.png\n\nPlotting a continuum spectrum at t=13000 Myr::\n\n  peg = ... # one I made earlier with defaults\n  spectra = peg.spectra(time_lower=13000, time_upper=13000)\n  lambdas = []\n  vals = []\n  filters = (4010, 7010) # lower, upper wavelengths (roughly V)\n  for col in spectra.colnames:\n      try:\n          l = float(col)\n          if l > filters[0] and l < filters[1]:\n              lambdas.append(l)\n              vals.append(spectra[col][0])\n      except ValueError:\n          pass # Column is not a number (i.e. wavelength)\n  plot(lambdas[:149], vals[:149], \"b-\") # Removed the lines for this example\n  xlabel(\"wavelength (Angstroms)\")\n  ylabel(\"flux\")\n\n.. image:: images/example_spectra.png\n\t\nSpecifying parameters explicitly (these are all the default values and any can be omitted)::\n\n    peg = PEGASE(\"custom\", ssps=SSP(\n        IMF(IMF.IMF_Salpeter), ejecta=SNII_ejecta.MODEL_B, winds=True\n    ), scenario=Scenario(\n        binaries_fraction=0.04, metallicity_ism_0=0, infall=False, sfr=SFR(SFR.EXPONENTIAL_DECREASE, p1=1e3, p2=1),\n        metallicity_evolution=True, substellar_fraction=0, winds=False, neb_emission=True,\n        extinction=Extinction.NO_EXTINCTION\n    ))\n    peg.generate()\n    spec = peg.spectra(cols=['time', 'l_bol', '7135.00'])\n    spec['l_bol'][20] # == 2.499E34\n\nExperimenting with IMFs::\n\n    # Built-in\n    imf = IMF(IMF.IMF_Scalo86)\n    imf = IMF(IMF.IMF_MillerScalo) # and so on for built-in IMFs\n\n    # Custom\n    imf = IMF(IMF.CUSTOM, lower_mass=0.1, upper_mass=120, gamma=-1.35) # A custom IMF equivalent to Salpeter with\n                                                                       # default cutoffs\n    imf = IMF(IMF.CUSTOM, lower_mass=0.1, upper_mass=120, powers=[\n        (0.1, -0.4),\n        (1., -1.5),\n        (10., -2.3)\n    ]) # A custom IMF equivalent to Miller-Scalo (see IMF_MillerScalo.dat)\n\n    peg = PEGASE(\"custom_imf\", ssps=SSP(imf))\n\nGenerating a series of models with varying parameters::\n\n    pegase = PEGASE('test')\n    for gamma in np.arange(-1.7, -1.0, 0.05):\n        # Reuse the same instance each iteration\n        pegase.name = \"imftest_\" + str(gamma)\n        pegase.ssps.imf = IMF(IMF.CUSTOM, gamma=gamma)\n        pegase.generate()\n        pegase.save_to_file(pegase.name + \".peg\")\n\nPlotting the results::\n\n    pegs = PEGASE.from_dir(\".\")\n    # Now we have a list of PEGASE instances\n\n    for i, peg in enumerate(pegs):\n        colors = peg.colors(cols=['B-V']) # Note 'time' included by default\n        plt.plot(colors['time'], colors['B-V'])\n\n    plt.suptitle(r'Color vs time for varying IMF gradient')\n    plt.xlabel('time (Myr)')\n    plt.ylabel('color (B-V)')\n    plt.show()\n\n.. image:: images/example.png\n\nFurther work\n------------\n\nFuture versions will include:\n\n- Passing a redshift value into spectra and colors\n- Custom filters\n- Calculating colors directly from spectra information\n- Better ability to handle customised installations of PEGASE, in particular an altered IMF list/timesteps\n- Ability to instantiate from a dictionary, JSON and other formats\n- Ability to access color and spectra data by time as well as row number\n- More intuitive use of multiple scenarios\n- Ability to specify your own defaults\n- Simplified process for wrapping an existing run (will examine the file system and reverse-engineer the parameters)\n- Human-readable pickled (saved) files\n- Unit tests for a greater variety of scenarios\n- A more robust ``copy()`` implementation\n- Console GUI\n\nAcknowledgement\n---------------\nPyPegase was written with the support of the Centre for Astrophysics and Supercomputing at\nSwinburne University of Technology.\n", 
  "description": "Python wrapper around the P\u00e9gase V.2 galaxy spectral model (http://www2.iap.fr/users/fioc/PEGASE.html)."
}