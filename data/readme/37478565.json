{
  "README.Rmd": "---\noutput:\n  md_document:\n    variant: markdown_github\n---\n\n```{r, echo = FALSE}\nknitr::opts_chunk$set(\n    collapse = TRUE,\n    comment = \"#>\",\n    fig.path = \"inst/README-\"\n)\n```\n\nkdecopula\n=========\n> Kernel smoothing for bivariate copula densities\n\n[![Build status Linux](https://travis-ci.org/tnagler/kdecopula.svg?branch=master)](https://travis-ci.org/tnagler/kdecopula)\n[![CRAN version](http://www.r-pkg.org/badges/version/kdecopula)](https://cran.r-project.org/web/packages/kdecopula/index.html)\n[![CRAN downloads](http://cranlogs.r-pkg.org/badges/kdecopula)](https://cran.r-project.org/web/packages/kdecopula/index.html)  \n\nThis package provides fast implementations of kernel estimators for the copula \ndensity. Due to its several plotting options it is particularly useful for the \nexploratory analysis of dependence structures. It can be further used for flexible\nnonparametric estimation of copula densities and resampling.\n\n\nA detailed package description is available in the package vignette:\n``` r\nlibrary(\"kdecopula\")\nvignette(\"kdecopula\")\n````\n\n\n\n## Table of contents\n\n- [How to install](#how-to-install)\n- [Functions](#functions)\n- [kdecopula in action](#kdecopula-in-action)\n    - [Estimation of bivariate copula densities](#estimation-of-bivariate-copula-densities)\n\t- [Plotting bivariate copula densities](#plotting-bivariate-copula-densities)\n\t- [Working with a kdecopula object](#working-with-a-kdecopula-object)\n- [References](#references)\n\t\n----------------------------------------------------------------\n\t\n## How to install\n\nYou can install:\n\n* the stable release on CRAN:\n``` r\ninstall.pacakges(\"kdecopula\")\n````\n\n* the latest development version:\n``` r\ndevtools::install_github(\"tnagler/kdecopula\")\n````\n\n## Functions\n\nThe package provides the following functions:\n\n  * `kdecop`: Kernel estimation of a copula density. By default, estimation\n  method and bandwidth are selected automatically. Returns an object of class\n  `kdecopula`.\n  \n  * `dkdecop`: Evaluates the density of a `kdecopula` object.\n  \n  * `pkdecop`: Evaluates the distribution function of a `kdecopula` object.\n  \n  * `rkdecop`: Simulates synthetic data from a `kdecopula` object.\n  \n  * Methods for class `kdecopula`: \n  \n    * `plot`, `contour`: Surface and contour plots of the density estimate. \n    \n    * `print`, `summary`: Displays further information about the density\n      estimate.    \n      \n    * `logLik`, `AIC`, `BIC`: Extracts fit statistics.\n\nPlease look up the package documentation for more details on arguments and\noptions. \n\n\n----------------------------------------------------------------\n\n## kdecopula in action\n\n```{r echo = FALSE}\nset.seed(2)\n```\n\nBelow, we demonstrate the main capabilities of the `kdecopula` \npackage. All user-level functions will be introduced with small examples. \n\nLet's consider some variables of the *Wiscon diagnostic breast cancer* data \nincluded in this package. The data are transformed to pseudo-observations of\nthe copula by the empirical probability integral/rank transform:\n\n\n```{r fig.width=4, fig.height=4}\nlibrary(kdecopula)\ndata(wdbc)  # load data\nu <- apply(wdbc[, c(2, 8)], 2, rank) / (nrow(wdbc) + 1)  # empirical PIT\nplot(u)  # scatter plot\n```\n\nWe see that the data are slightly asymmetric w.r.t. both diagonals. Common\nparametric copula models are usually not flexible enough to reflect this. Let's\nsee how a kernel estimator does.\n\n\n#### Estimation of bivariate copula densities\n\nWe start by estimating the copula density with the `kdecop` function. There is\na number of options for the smoothing parameterization, estimation method and \nevaluation grid, but it is only required to provide a data-matrix.\n\n```{r}\nkde.fit <- kdecop(u)  # kernel estimation (bandwidth selected automatically)\nsummary(kde.fit)\n```\n\nThe output of the function `kdecop` is an object of class `kdecopula` that \ncontains all information collected during the estimation process and summary\nstatistics such as *AIC* or the *effective number of parameters/degrees of\nfreedom*. These can also be accessed directly, e.g.\n```{r}\nlogLik(kde.fit)\nAIC(kde.fit)\n```\n\n#### Plotting bivariate copula densities\n\nThe most interesting part for most people is probably to make exploratory plots. \nThe class `kdecopula` has its own generic for plotting. In general, there are\ntwo possible types of plots: *contour* and *surface* (or perspective) plots. \nAdditionally, the `margins` argument allows to choose between plots of the \noriginal copula density and a meta-copula density with standard normal margins \n(default for `type = contour`).\n\n```{r fig.width=4, fig.height=4}\nplot(kde.fit)\n```\n```{r fig.width=4, fig.height=4}\ncontour(kde.fit)\n```\n```{r fig.width=4, fig.height=4}\ncontour(kde.fit, margins = \"unif\")\n```\n\nYou can also pass further arguments to the `...` argument to refine the\naesthetics. The arguments are forwaded to  \n`lattice::wireframe` or `graphics::contour`, respectively.\n```{r fig.width=4, fig.height=4}\nplot(kde.fit, \n     zlim = c(0, 10),  # z-axis limits\n     screen = list(x = -75, z = 45),  # rotate screen\n     xlab = list(rot = 25),  # labels can be rotated as well\n     ylab = list(label = \"other label\", rot = -25))  \n```\n```{r fig.width=4, fig.height=4}\ncontour(kde.fit, col = terrain.colors(30), levels = seq(0, 0.3, by = 0.01))\n```\n\n#### Working with a `kdecopula` object\n\nThe density and *cdf* can be computed easily:\n\n```{r}\ndkdecop(c(0.1, 0.2), kde.fit)  # estimated copula density\npkdecop(cbind(c(0.1, 0.9), c(0.1, 0.9)), kde.fit) # corresponding copula cdf\n```\n\nFurthermore, we can simulate synthetic data from the estimated density:\n```{r fig.width=4, fig.height=4}\nunew <- rkdecop(655, kde.fit)\nplot(unew)\n```\n\nWe see that the asymmetries observed in the data are adequately reflected by\nthe estimated model.\n\n## References\n\nGijbels, I. and Mielniczuk, J. (1990). Estimating the density of a copula \nfunction. *Communications in Statistics - Theory and Methods*, 19(2):445-464. \n\nCharpentier, A., Fermanian, J.-D., and Scaillet, O. (2006). The estimation of \ncopulas: Theory and practice. In Rank, J., editor, Copulas: From theory to\napplication in finance. Risk Books. \n\nGeenens, G., Charpentier, A., and Paindaveine, D. (2014). Probit transformation\nfor nonparametric kernel estimation of the copula density. \n[*arXiv:1404.4414 (stat.ME)*](arxiv.org/abs/1404.4414).\n\nNagler, T. (2014). Kernel Methods for Vine Copula Estimation. [*Master's Thesis,\nTechnische Universitat Munchen*](https://mediatum.ub.tum.de/node?id=1231221)\n\nWen, K. and Wu, X. (2015). Transformation-Kernel Estimation of the Copula \nDensity, Working paper, [preprint](http://agecon2.tamu.edu/people/faculty/wu-ximing/agecon2/public/copula.pdf)\n", 
  "read_at": 1462549626, 
  "description": "Kernel smoothing for bivariate copula densities", 
  "README.md": "kdecopula\n=========\n\n> Kernel smoothing for bivariate copula densities\n\n[![Build status Linux](https://travis-ci.org/tnagler/kdecopula.svg?branch=master)](https://travis-ci.org/tnagler/kdecopula) [![CRAN version](http://www.r-pkg.org/badges/version/kdecopula)](https://cran.r-project.org/web/packages/kdecopula/index.html) [![CRAN downloads](http://cranlogs.r-pkg.org/badges/kdecopula)](https://cran.r-project.org/web/packages/kdecopula/index.html)\n\nThis package provides fast implementations of kernel estimators for the copula density. Due to its several plotting options it is particularly useful for the exploratory analysis of dependence structures. It can be further used for flexible nonparametric estimation of copula densities and resampling.\n\nA detailed package description is available in the package vignette:\n\n``` r\nlibrary(\"kdecopula\")\nvignette(\"kdecopula\")\n```\n\nTable of contents\n-----------------\n\n-   [How to install](#how-to-install)\n-   [Functions](#functions)\n-   [kdecopula in action](#kdecopula-in-action)\n    -   [Estimation of bivariate copula densities](#estimation-of-bivariate-copula-densities)\n    -   [Plotting bivariate copula densities](#plotting-bivariate-copula-densities)\n    -   [Working with a kdecopula object](#working-with-a-kdecopula-object)\n-   [References](#references)\n\n------------------------------------------------------------------------\n\nHow to install\n--------------\n\nYou can install:\n\n-   the stable release on CRAN:\n\n    ``` r\n    install.pacakges(\"kdecopula\")\n    ```\n\n-   the latest development version:\n\n    ``` r\n    devtools::install_github(\"tnagler/kdecopula\")\n    ```\n\nFunctions\n---------\n\nThe package provides the following functions:\n\n-   `kdecop`: Kernel estimation of a copula density. By default, estimation method and bandwidth are selected automatically. Returns an object of class `kdecopula`.\n\n-   `dkdecop`: Evaluates the density of a `kdecopula` object.\n\n-   `pkdecop`: Evaluates the distribution function of a `kdecopula` object.\n\n-   `rkdecop`: Simulates synthetic data from a `kdecopula` object.\n\n-   Methods for class `kdecopula`:\n\n    -   `plot`, `contour`: Surface and contour plots of the density estimate.\n\n    -   `print`, `summary`: Displays further information about the density estimate.\n\n    -   `logLik`, `AIC`, `BIC`: Extracts fit statistics.\n\nPlease look up the package documentation for more details on arguments and options.\n\n------------------------------------------------------------------------\n\nkdecopula in action\n-------------------\n\nBelow, we demonstrate the main capabilities of the `kdecopula` package. All user-level functions will be introduced with small examples.\n\nLet's consider some variables of the *Wiscon diagnostic breast cancer* data included in this package. The data are transformed to pseudo-observations of the copula by the empirical probability integral/rank transform:\n\n``` r\nlibrary(kdecopula)\ndata(wdbc)  # load data\nu <- apply(wdbc[, c(2, 8)], 2, rank) / (nrow(wdbc) + 1)  # empirical PIT\nplot(u)  # scatter plot\n```\n\n![](inst/README-unnamed-chunk-3-1.png)<!-- -->\n\nWe see that the data are slightly asymmetric w.r.t. both diagonals. Common parametric copula models are usually not flexible enough to reflect this. Let's see how a kernel estimator does.\n\n#### Estimation of bivariate copula densities\n\nWe start by estimating the copula density with the `kdecop` function. There is a number of options for the smoothing parameterization, estimation method and evaluation grid, but it is only required to provide a data-matrix.\n\n``` r\nkde.fit <- kdecop(u)  # kernel estimation (bandwidth selected automatically)\nsummary(kde.fit)\n#> Kernel copula density estimate\n#> ------------------------------\n#> Variables:    mean radius -- mean concavity \n#> Observations: 569 \n#> Method:       Transformation local likelihood, log-quadratic ('TLL2') \n#> Bandwidth:    alpha = 0.353621\n#>               B = matrix(c(0.71, 0.7, -1.09, 1.09), 2, 2)\n#> ---\n#> logLik: 197.28    AIC: -360.19    cAIC: -359.06    BIC: -285.56 \n#> Effective number of parameters: 17.18\n```\n\nThe output of the function `kdecop` is an object of class `kdecopula` that contains all information collected during the estimation process and summary statistics such as *AIC* or the *effective number of parameters/degrees of freedom*. These can also be accessed directly, e.g.\n\n``` r\nlogLik(kde.fit)\n#> 'log Lik.' 197.2755 (df=17.18016)\nAIC(kde.fit)\n#> [1] -360.1907\n```\n\n#### Plotting bivariate copula densities\n\nThe most interesting part for most people is probably to make exploratory plots. The class `kdecopula` has its own generic for plotting. In general, there are two possible types of plots: *contour* and *surface* (or perspective) plots. Additionally, the `margins` argument allows to choose between plots of the original copula density and a meta-copula density with standard normal margins (default for `type = contour`).\n\n``` r\nplot(kde.fit)\n```\n\n![](inst/README-unnamed-chunk-6-1.png)<!-- -->\n\n``` r\ncontour(kde.fit)\n```\n\n![](inst/README-unnamed-chunk-7-1.png)<!-- -->\n\n``` r\ncontour(kde.fit, margins = \"unif\")\n```\n\n![](inst/README-unnamed-chunk-8-1.png)<!-- -->\n\nYou can also pass further arguments to the `...` argument to refine the aesthetics. The arguments are forwaded to\n`lattice::wireframe` or `graphics::contour`, respectively.\n\n``` r\nplot(kde.fit, \n     zlim = c(0, 10),  # z-axis limits\n     screen = list(x = -75, z = 45),  # rotate screen\n     xlab = list(rot = 25),  # labels can be rotated as well\n     ylab = list(label = \"other label\", rot = -25))  \n```\n\n![](inst/README-unnamed-chunk-9-1.png)<!-- -->\n\n``` r\ncontour(kde.fit, col = terrain.colors(30), levels = seq(0, 0.3, by = 0.01))\n```\n\n![](inst/README-unnamed-chunk-10-1.png)<!-- -->\n\n#### Working with a `kdecopula` object\n\nThe density and *cdf* can be computed easily:\n\n``` r\ndkdecop(c(0.1, 0.2), kde.fit)  # estimated copula density\n#> [1] 1.690376\npkdecop(cbind(c(0.1, 0.9), c(0.1, 0.9)), kde.fit) # corresponding copula cdf\n#> [1] 0.03254441 0.85154412\n```\n\nFurthermore, we can simulate synthetic data from the estimated density:\n\n``` r\nunew <- rkdecop(655, kde.fit)\nplot(unew)\n```\n\n![](inst/README-unnamed-chunk-12-1.png)<!-- -->\n\nWe see that the asymmetries observed in the data are adequately reflected by the estimated model.\n\nReferences\n----------\n\nGijbels, I. and Mielniczuk, J. (1990). Estimating the density of a copula function. *Communications in Statistics - Theory and Methods*, 19(2):445-464.\n\nCharpentier, A., Fermanian, J.-D., and Scaillet, O. (2006). The estimation of copulas: Theory and practice. In Rank, J., editor, Copulas: From theory to application in finance. Risk Books.\n\nGeenens, G., Charpentier, A., and Paindaveine, D. (2014). Probit transformation for nonparametric kernel estimation of the copula density. [*arXiv:1404.4414 (stat.ME)*](arxiv.org/abs/1404.4414).\n\nNagler, T. (2014). Kernel Methods for Vine Copula Estimation. [*Master's Thesis, Technische Universitat Munchen*](https://mediatum.ub.tum.de/node?id=1231221)\n\nWen, K. and Wu, X. (2015). Transformation-Kernel Estimation of the Copula Density, Working paper, [preprint](http://agecon2.tamu.edu/people/faculty/wu-ximing/agecon2/public/copula.pdf)\n", 
  "id": 37478565
}